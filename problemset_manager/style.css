:root {
  --bg: #0f1216;
  --panel: #161b22;
  --muted: #8b949e;
  --text: #e6edf3;
  --brand: #ffa116;      /* LeetCode 橙 */
  --accent-2: #388bfd;   /* 备用蓝（链接/次级） */
  --danger: #f85149;
  --border: #30363d;
  --chip: #21262d;
  --chip-border: #30363d;
  --chip-text: #c9d1d9;
  --input-bg: #0b0e12;

  --scrollbar: #2a2f36;
  --scrollbar-thumb: #3a4048;
  --scrollbar-thumb-hover: #4a5160;

  --chip-gap-x: 8px;
  --chip-gap-y: 6px;
  --chip-font: 12px;
  --chip-pad-y: 2px;
  --chip-pad-x: 8px;
  --chip-del-size: 18px;
  --chip-del-font: 11px;

  --tag-sel-w: 118px;
  --tag-btn-w: 68px;
}

* { box-sizing: border-box; }

html, body {
  height: 100%;
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font: 14px/1.5 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial;
}

#app {
  display: grid;
  grid-template-columns: 280px 1fr;
  height: 100%;
}

/* Sidebar */
.sidebar {
  border-right: 1px solid var(--border);
  background: var(--panel);
  display: flex;
  flex-direction: column;
  min-width: 240px;
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px;
  border-bottom: 1px solid var(--border);
}

.sidebar-header h1 {
  font-size: 16px;
  margin: 0;
  letter-spacing: .3px;
}

.sidebar-header button {
  background: var(--accent-2);
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
  white-space: nowrap;
  word-break: keep-all;
}

#lists {
  overflow: auto;
  padding: 8px;
  flex: 1;
}

.list-item {
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 10px;
  margin-bottom: 10px;
  background: #0f1319;
  cursor: pointer;
  transition: border-color .12s ease, transform .05s ease;
}
.list-item:hover { border-color: #3a7bfd44; }
.list-item:active { transform: scale(0.998); }

.list-item.active {
  border-color: var(--accent-2);
  outline: 1px solid var(--accent-2);
}

.list-item .meta {
  color: var(--muted);
  font-size: 12px;
  margin-top: 2px;
}

/* Sidebar actions */
.sidebar-actions {
  padding: 12px;
  border-top: 1px solid var(--border);
  display: flex;
  gap: 8px;
}
.sidebar-actions button,
.sidebar-actions .import-label {
  background: #21262d;
  color: var(--text);
  border: 1px solid var(--border);
  padding: 6px 10px;
  border-radius: 8px;
  cursor: pointer;
  white-space: nowrap;
  word-break: keep-all;
  transition: border-color .12s ease, background .12s ease;
}
.sidebar-actions button:hover,
.sidebar-actions .import-label:hover { border-color: var(--accent-2); }
.import-label input { display: none; }

/* Main */
.main {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* 顶部工具栏：吸顶、轻阴影、LeetCode 风格间距 */
.toolbar {
  position: sticky;
  top: 0;
  z-index: 50;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  background: var(--panel);
  box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

.current-list {
  display: flex;
  gap: 8px;
  align-items: center;
  min-width: 300px;
  flex: 1 1 420px;
}

#list-name-input {
  flex: 1 1 200px;
  min-width: 160px;
  padding: 6px 8px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--text);
}

button {
  background: #21262d;
  color: var(--text);
  border: 1px solid var(--border);
  padding: 6px 12px;
  border-radius: 999px;   /* 胶囊形按钮（LeetCode 风格） */
  cursor: pointer;
  white-space: nowrap;
  word-break: keep-all;
  flex-shrink: 0;
  transition: border-color .12s ease, background .12s ease, transform .05s ease;
}
button:hover { border-color: var(--accent-2); }
button:active { transform: translateY(1px); }
button.danger { border-color: var(--danger); color: #ffd2cf; }

.search {
  display: flex;
  gap: 8px;
  align-items: center;
  flex: 1 1 380px;
  min-width: 240px;
}

.search input {
  flex: 1;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--text);
}

.actions {
  display: flex;
  gap: 8px;
  align-items: center;
  flex: 1 1 100%;
  width: 100%;
  overflow-x: auto;   /* 小屏时横向滚动 */
  overflow-y: hidden;
  padding-bottom: 4px;
  scrollbar-gutter: stable;
}
.actions > * { flex: 0 0 auto; }
.actions .import-label {
  display: inline-flex;
  align-items: center;
  background: #21262d;
  color: var(--text);
  border: 1px solid var(--border);
  padding: 6px 12px;
  border-radius: 999px;
  cursor: pointer;
  white-space: nowrap;
  word-break: keep-all;
}
.actions .import-label:hover { border-color: var(--accent-2); }
.actions .import-label input { display: none; }

/* 移除旧的折叠开关 */
#actions-toggle, #actions-toggle.open { display: none !important; }

/* 表格区域：表头 sticky、行 hover、条纹背景；小屏卡片化 */
.table-wrap { overflow: auto; padding: 12px; position: relative; }

table { width: 100%; border-collapse: collapse; }

thead th {
  position: sticky;
  top: 0;
  z-index: 2;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}

th, td {
  border-bottom: 1px solid var(--border);
  padding: 10px 8px;
  vertical-align: middle;
  white-space: nowrap;
}

.problems-table tbody tr:nth-child(odd) { background: rgba(255,255,255,0.015); }
.problems-table tbody tr:hover { background: rgba(255,255,255,0.03); }

.cell-link, .cell-tags, .cell-code { text-align: center; }
.cell-difficulty { text-align: center; }

td a {
  color: var(--accent-2);
  text-decoration: none;
  word-break: break-all;
}

/* 紧凑输入和小按钮（用于行内编辑） */
.input-sm {
  width: 100%;
  padding: 4px 8px;
  height: 30px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--text);
  font-size: 13px;
  line-height: 1.2;
}
.btn-ghost {
  background: transparent;
  border: 1px dashed var(--border);
  color: var(--muted);
  white-space: nowrap;
  word-break: keep-all;
  border-radius: 999px;
}
.btn-ghost:hover { border-color: var(--accent-2); color: var(--text); }
.btn-xs {
  padding: 2px 10px;
  font-size: 12px;
  line-height: 1.2;
  height: 26px;
}

/* 标签（表格内） */
.tag-wrap {
  display: inline-flex;
  flex-wrap: wrap;
  gap: 6px;
  align-items: center;
}
.tag-wrap.centered { justify-content: center; }
.tag-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 2px 10px;
  border-radius: 999px;
  background: #1a1f27;
  border: 1px solid #2b313a;
  color: var(--chip-text);
  font-size: 12px;
}
.tag-chip .remove { cursor: pointer; color: var(--muted); }

.add-tag-btn {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  width: 24px; height: 24px;
  border-radius: 999px;
  border: 1px dashed var(--border);
  color: var(--muted);
  background: transparent;
  margin-left: 6px;
  font-size: 14px;
  white-space: nowrap;
}
.add-tag-btn:hover { border-color: var(--accent-2); color: var(--accent-2); }

/* 弹出面板（popover） */
.popover {
  position: absolute;
  z-index: 10;
  min-width: 320px;
  max-width: 460px;
  max-height: 360px;
  overflow-y: scroll;
  overflow-x: hidden;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.35);
  padding: 8px;
  scrollbar-gutter: stable both-edges;
}
.pop-section { margin-bottom: 8px; }
.pop-section h4 {
  margin: 4px 0 6px;
  font-size: 12px;
  color: var(--muted);
}
.cat-item {
  border: 1px solid var(--border);
  border-radius: 8px;
  margin-bottom: 6px;
  background: #0f1319;
}
.cat-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 8px;
  cursor: pointer;
}
.cat-head:hover { background: #151a22; }
.cat-body { display: none; padding: 6px 8px; max-height: 160px; overflow: auto; }
.cat-body.open { display: block; }
.cat-tags { display: flex; flex-wrap: wrap; gap: 6px; }
.cat-tags .tag-chip { cursor: pointer; }

/* Modal */
.modal.hidden { display: none; }
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: grid;
  place-items: center;
  z-index: 1000;
}
.modal-content {
  width: min(900px, 92vw);
  max-height: 88vh;
  overflow: auto;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
}
.modal-header, .modal-footer {
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.modal-footer { border-top: 1px solid var(--border); border-bottom: none; }
.modal-body { padding: 12px; }

/* 标签库标题栏 sticky（不随内容滚动） */
#tags-modal .modal-header {
  position: sticky;
  top: 0;
  z-index: 2;
  background: var(--panel);
}

/* 任意 modal-header 的最后一个按钮靠右 */
.modal-header > h2 { margin: 0; }
.modal-header > button:last-child { margin-left: auto; }

.taglib-toolbar { margin-bottom: 8px; }
.lib-cat {
  border: 1px solid var(--border);
  border-radius: 10px;
  margin-bottom: 10px;
  background: #0f1319;
}
.lib-cat-head {
  display: flex;
  gap: 8px;
  align-items: center;
  padding: 8px 10px;
  border-bottom: 1px solid var(--border);
}
.lib-cat-head .spacer { flex: 1; }
.lib-cat-body { padding: 8px 10px; }

.lib-chip-list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--chip-gap-y) var(--chip-gap-x);
  margin: 6px 0;
}
.lib-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: var(--chip-pad-y) var(--chip-pad-x);
  border-radius: 999px;
  background: #0f1319;
  border: 1px solid var(--border);
  color: var(--text);
  font-size: var(--chip-font);
  line-height: 1.2;
  white-space: nowrap;
}
.chip-del {
  width: var(--chip-del-size);
  height: var(--chip-del-size);
  padding: 0;
  line-height: calc(var(--chip-del-size) - 2px);
  font-size: var(--chip-del-font);
  border-radius: 6px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 4px;
}

/* 拖拽视觉 */
.drag-placeholder {
  height: 10px;
  margin: 4px 0;
  border: 2px dashed var(--accent-2);
  border-radius: 6px;
}
.dragging { opacity: 0.6; cursor: grabbing; }

/* 尺寸按钮 */
.btn-xxs {
  height: 24px;
  padding: 2px 10px;
  font-size: 12px;
  line-height: 1.2;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  white-space: nowrap;
}
.btn-primary {
  background: var(--brand);
  border-color: var(--brand);
  color: #111;
}
.btn-primary:hover { filter: brightness(1.06); }

/* Toolbar 响应式（flex 布局） */
@media (max-width: 1100px) {
  .current-list { flex: 1 1 100%; }
  .search { flex: 1 1 100%; }
  .actions { flex: 1 1 100%; }
}

/* 左边缘展开按钮（小屏显示） */
.edge-open-btn {
  position: fixed;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  z-index: 1210;
  display: none; /* ≤900px 且侧栏未展开时由 JS 控制 display */
  align-items: center;
  justify-content: center;
  gap: 6px;
  height: 36px;
  padding: 0 10px;
  background: var(--accent-2);
  border: 1px solid var(--accent-2);
  border-left: none;
  border-radius: 0 10px 10px 0;
  color: #fff;
  cursor: pointer;
  white-space: nowrap;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

/* 窄屏侧栏抽屉与遮罩 */
.sidebar-backdrop {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45);
  z-index: 1190;
}
.sidebar-backdrop.show { display: block; }

#sidebar-toggle { display: none !important; }

@media (max-width: 900px) {
  #app { grid-template-columns: 1fr; }
  .sidebar {
    position: fixed;
    left: 0; top: 0; bottom: 0;
    width: min(85vw, 320px);
    transform: translateX(-100%);
    transition: transform 0.2s ease;
    z-index: 1200;
    box-shadow: 0 8px 24px rgba(0,0,0,0.35);
  }
  .sidebar.open { transform: translateX(0); }
  .edge-open-btn { display: inline-flex; } /* 初始展示，展开后 JS 隐藏 */
}

/* 预设区间 */
.preset-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 8px;
}
.preset-chip {
  font-size: 12px;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: #0f1319;
  color: var(--text);
  cursor: pointer;
  white-space: nowrap;
}
.preset-chip:hover { border-color: var(--accent-2); color: var(--accent-2); }

/* Number 输入去掉原生箭头 */
input[type="number"] {
  appearance: textfield;
  -moz-appearance: textfield;
  -webkit-appearance: none;
}
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none !important;
  appearance: none !important;
  margin: 0;
  opacity: 0;
  pointer-events: none;
}

/* 自定义右侧上下按钮（纯 CSS 三角） */
.spin-wrap { position: relative; display: inline-block; }
.spin-wrap .input-sm { padding-right: 30px; }
.spin-ctl {
  position: absolute; right: 2px; top: 2px; bottom: 2px; width: 24px;
  display: flex; flex-direction: column; gap: 2px;
}
.spin-mini {
  flex: 1 1 0; min-height: 0; padding: 0; border-radius: 6px;
  background: var(--chip); border: 1px solid var(--chip-border);
  cursor: pointer; display: inline-flex; align-items: center; justify-content: center;
  user-select: none;
}
.spin-mini:hover { border-color: var(--accent-2); }
.spin-mini:active { background: #1a1f27; }
.spin-mini[data-dir="up"]::before {
  content: ""; width: 0; height: 0; display: block;
  border-left: 6px solid transparent; border-right: 6px solid transparent;
  border-bottom: 8px solid var(--muted);
  transition: border-bottom-color .15s ease;
}
.spin-mini[data-dir="up"]:hover::before { border-bottom-color: var(--text); }
.spin-mini[data-dir="down"]::before {
  content: ""; width: 0; height: 0; display: block;
  border-left: 6px solid transparent; border-right: 6px solid transparent;
  border-top: 8px solid var(--muted);
  transition: border-top-color .15s ease;
}
.spin-mini[data-dir="down"]:hover::before { border-top-color: var(--text); }

/* 细滚动条（美化） */
.scrollable,
.popover,
.modal-content,
#lists,
.table-wrap,
.cat-body,
.lib-cat-body,
.actions {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) transparent;
}
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb);
  border-radius: 8px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
::-webkit-scrollbar-thumb:hover { background-color: var(--scrollbar-thumb-hover); }
.popover::-webkit-scrollbar,
.modal-content::-webkit-scrollbar,
#lists::-webkit-scrollbar,
.table-wrap::-webkit-scrollbar,
.cat-body::-webkit-scrollbar,
.lib-cat-body::-webkit-scrollbar,
.actions::-webkit-scrollbar {
  width: 8px; height: 8px;
}
.popover::-webkit-scrollbar-thumb,
.modal-content::-webkit-scrollbar-thumb,
#lists::-webkit-scrollbar-thumb,
.table-wrap::-webkit-scrollbar-thumb,
.cat-body::-webkit-scrollbar-thumb,
.lib-cat-body::-webkit-scrollbar-thumb,
.actions::-webkit-scrollbar-thumb {
  border-radius: 8px;
}
.popover::-webkit-scrollbar-track,
.modal-content::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.03);
  border-radius: 8px;
}

/* 随机CF弹窗：标题栏置顶；底部按钮靠右 */
#cf-random-modal .modal-header {
  position: sticky;
  top: 0;
  z-index: 2;
  background: var(--panel);
}
#cf-random-modal .modal-footer {
  justify-content: flex-end;
}

/* 移动端卡片化表格 */
@media (max-width: 760px) {
  .problems-table { border: 0; }
  .problems-table thead { display: none; }
  .problems-table, .problems-table tbody, .problems-table tr, .problems-table td {
    display: block;
    width: 100%;
  }
  .problems-table tbody tr {
    background: #0f1319;
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 10px;
    margin-bottom: 10px;
  }
  .problems-table td {
    border: 0;
    padding: 8px 0;
    display: flex;
    gap: 8px;
    align-items: center;
    justify-content: space-between;
    white-space: normal; /* 允许内容换行 */
  }
  .problems-table td::before {
    content: attr(data-label);
    color: var(--muted);
    font-size: 12px;
    margin-right: 10px;
    flex: 0 0 auto;
  }
  .cell-tags { justify-content: flex-start; }
  .cell-actions { justify-content: flex-end; }
}

/* 窄屏：chip 更紧凑 */
@media (max-width: 900px) {
  :root {
    --chip-gap-x: 6px;
    --chip-gap-y: 5px;
    --chip-font: 11.5px;
    --chip-pad-x: 7px;
    --chip-del-size: 16px;
    --chip-del-font: 10px;
  }
}
